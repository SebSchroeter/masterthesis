rm(list = ls())
library(tidyr)
library(httpgd)
library(zoib)
library(arrow)
library(brms)
setwd("~/Sebastian Masterthesis/Git repo/masterthesis")
df<-read_feather("long_df.feather")
df$Country<-factor(df$Country)
df$pm<-factor(df$pm)
fit_ols<-lm(unweighted_ministries~mvw+factor(pm),data = df)
summary(fit_ols)
fit_ols_fe<-lm(unweighted_ministries~mvw+factor(pm)+factor(Country),data = df)
summary(fit_ols_fe)
fit_ols_seats<-lm(unweighted_ministries~mvw+Seats+factor(pm),data = df)
summary(fit_ols_seats)
fit_ols_weighted<-lm(unweighted_ministries~mvw+factor(pm),data = df)
summary(fit_ols)
fit_ols_fe_weighted<-lm(unweighted_ministries~mvw+factor(pm)+factor(Country),data = df)
summary(fit_ols_fe)
fit_ols_seats_weighted<-lm(weighted_ministries~mvw+Seats+factor(pm),data = df)
summary(fit_ols_seats)
stargazer(fit_ols,fit_ols_fe,fit_ols_seats,fit_ols_seats_weighted,
title = "OLS Results",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser"),
dep.var.labels = c("Share of Ministries","Weighted Share"),
column.labels=c("Basic","FE","Seat Share","Combined","Combined"),
no.space = T,
float.env = "sidewaystable")
library(stargazer)
a
stargazer(fit_ols,fit_ols_fe,fit_ols_seats,fit_ols_seats_weighted,
title = "OLS Results",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser"),
dep.var.labels = c("Share of Ministries","Weighted Share"),
column.labels=c("Basic","FE","Seat Share","Combined","Combined"),
no.space = T,
float.env = "sidewaystable")
stargazer(fit_ols,fit_ols_fe,fit_ols_seats,fit_ols_seats_weighted,
title = "OLS Results",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
dep.var.labels = c("Share of Ministries","Weighted Share"),
column.labels=c("Basic","FE","Seat Share","Combined","Combined"),
no.space = T,
style = "aer"
#float.env = "sidewaystable"
)
stargazer(fit_ols,fit_ols_fe,fit_ols_seats,fit_ols_seats_weighted,
title = "OLS Results",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
dep.var.labels = c("Share of Ministries","Weighted Share"),
column.labels=c("Basic","FE","Seat Share","Combined","Combined"),
no.space = T,
style = "qje"
#float.env = "sidewaystable"
)
install.packages("MonteCarlo")
library(MonteCarlo)
setwd("~/Sebastian Masterthesis/Git repo/masterthesis")
df<-read_feather("long_df.feather")
df$Country<-factor(df$Country)
df$pm<-factor(df$pm)
View(df)
df$formateur<-sample(x=c(0,1),size = 1,replace = T,prob = c(1-df$Seats,df$Seats))
apply(df$formateur,1,sample(x=c(0,1),size = 1,replace = T,prob = c(1-df$Seats,df$Seats)))
df$formateur<-rbinom(n=nrow(df),size = 1,prob = df$Seats)
model<-lm(unweighted_ministries~mvw+Seats+factor(formateur),data = df)
summary(model)
summary(model$coefficients)
model$coefficients
View(model)
model[["coefficients"]][["(Intercept)"]]
summary(model)$coefficients
summary(model)$coefficients[,1]
summary(model)$coefficients[,4]
return(list("estimates"=estimates,"p_values"=p_values))
ols<-function(n,y,x1,x2){
#generate sample
df$formateur<-rbinom(n=nrow(df),size = 1,prob = df$Seats)
model<-lm(unweighted_ministries~mvw+Seats+factor(formateur),data = df)
estimates<-summary(model)$coefficients[,1]
p_values<-summary(model)$coefficients[,4]
return(list("estimates"=estimates,"p_values"=p_values))
}
ols<-function(df){
#generate sample
df$formateur<-rbinom(n=nrow(df),size = 1,prob = df$Seats)
model<-lm(unweighted_ministries~mvw+Seats+factor(formateur),data = df)
estimates<-summary(model)$coefficients[,1]
p_values<-summary(model)$coefficients[,4]
return(list("estimates"=estimates,"p_values"=p_values))
}
ols(df)
test<- MonteCarlo(ols,nrep = 1000,param_list = df)
test<- MonteCarlo(ols,nrep = 1000,param_list = c(df))
monte_carlo_ols <- function(df, n) {
# storage
all_estimates <- list()
all_p_values <- list()
# loop
for (i in 1:n) {
result <- ols(df)
all_estimates[[i]] <- result$estimates
all_p_values[[i]] <- result$p_values
}
# Convert list to DataFrame
estimates_df <- do.call(rbind, all_estimates)
p_values_df <- do.call(rbind, all_p_values)
# Return a list containing both DataFrames
return(list("estimates_df" = estimates_df, "p_values_df" = p_values_df))
}
monte_carlo_ols(df,1000)
mc-results<-monte_carlo_ols(df,5000)
mc_results<-monte_carlo_ols(df,5000)
View(mc_results)
mc_results$estimates_df
mc_results$estimates_df[,4]
hist(mc_results$estimates_df[,4])
View(df)
#loop over each parliament
for (parliament in parliaments){
indice<-which(df$Parliament==parliament)
#sample 1 formateur per batch as previously
formateurs<-sample(indice,size = 1,prob = df$Seats[indice])
df$formateur[indice]<-0
df$formateur[formateurs]<-1
}
ols_per_parliament<-function(df){
#overwrite formateurs
df$formateur<- NA
#list all parliaments
parliaments <- unique(df$Parliament)
#loop over each parliament
for (parliament in parliaments){
indice<-which(df$Parliament==parliament)
#sample 1 formateur per batch as previously
formateurs<-sample(indice,size = 1,prob = df$Seats[indice])
df$formateur[indice]<-0
df$formateur[formateurs]<-1
}
}
monte_carlo_ols <- function(df, n) {
# storage
all_estimates <- list()
all_p_values <- list()
# loop
for (i in 1:n) {
## decide whether to use independent formateurs or per-parliament wise: by using ols(df) or ols_per_parliament(df)
result <- ols_per_parliament(df)
all_estimates[[i]] <- result$estimates
all_p_values[[i]] <- result$p_values
}
# Convert list to DataFrame
estimates_df <- do.call(rbind, all_estimates)
p_values_df <- do.call(rbind, all_p_values)
# Return
return(list("estimates_df" = estimates_df, "p_values_df" = p_values_df))
}
mc_results<-monte_carlo_ols(df,5000)
hist(mc_results$estimates_df[,4])
View(mc_results)
ols_per_parliament<-function(df){
#overwrite formateurs
df$formateur<- NA
#list all parliaments
parliaments <- unique(df$Parliament)
#loop over each parliament
for (parliament in parliaments){
indice<-which(df$Parliament==parliament)
#sample 1 formateur per batch as previously
formateurs<-sample(indice,size = 1,prob = df$Seats[indice])
df$formateur[indice]<-0
df$formateur[formateurs]<-1
}
model<-lm(unweighted_ministries~mvw+Seats+factor(formateur),data = df)
#collect coeffitients and p values
estimates<-summary(model)$coefficients[,1]
p_values<-summary(model)$coefficients[,4]
return(list("estimates"=estimates,"p_values"=p_values))
}
mc_results<-monte_carlo_ols(df,5000)
hist(mc_results$p_values_df[,4])
hist(mc_results$p_values_df[,4],breaks = 20)
hist(mc_results$p_values_df[,4],breaks = c(0.01,0.05,0.1,0.2,1))
hist(mc_results$p_values_df[,4],breaks = c(0,0.01,0.05,0.1,0.2,1))
hist(mc_results$p_values_df[,4],breaks = 20)
hist(mc_results$estimates_df[,4])
hist(mc_results$estimates_df[,4],xlim = c(-0.1,0.1),breaks = 20)
hist(mc_results$estimates_df[,4],xlim = c(-0.1,0.1),breaks = 20,
main="Formateur-Coefficient Distribution",
xlab="Formateur-Coeffiecients",)
hist(mc_results$p_values_df[,4],breaks = 20,
main="Formateur-Coefficient p-Values",
xlab="p-values of fomateur-coefficients",)
fit_ols_mvw<-lm(unweighted_ministries~mvw+Seats+factor(pm),data = df)
fit_ols_ssi<-lm(unweighted_ministries~SS-I+Seats+factor(pm),data = df)
fit_ols_ssi<-lm(unweighted_ministries~'SS-I'+Seats+factor(pm),data = df)
fit_ols_ssi<-lm(unweighted_ministries~df$`SS-I`+Seats+factor(pm),data = df)
fit_ols_pbi<-lm(unweighted_ministries~df$`PB-I`+Seats+factor(pm),data = df)
stargazer(fit_ols_mvw,fit_ols_ssi,fit_ols_pbi,
title = "Power Indice comparison",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
column.labels=c("MVWs","SS-I","PB-I"),
no.space = T,
style = "qje"
#float.env = "sidewaystable"
)
fit_ols_mvw<-lm(unweighted_ministries~mvw,data = df)
fit_ols_ssi<-lm(unweighted_ministries~df$`SS-I`,data = df)
fit_ols_pbi<-lm(unweighted_ministries~df$`PB-I`,data = df)
fit_ols_mvw_seats<-lm(unweighted_ministries~mvw+Seats,data = df)
fit_ols_ssi_seats<-lm(unweighted_ministries~df$`SS-I`+Seats,data = df)
fit_ols_pbi_seats<-lm(unweighted_ministries~df$`PB-I`+Seats,data = df)
fit_ols_mvw_full<-lm(unweighted_ministries~mvw+Seats+factor(pm),data = df)
fit_ols_ssi_full<-lm(unweighted_ministries~df$`SS-I`+Seats+factor(pm),data = df)
fit_ols_pbi_full<-lm(unweighted_ministries~df$`PB-I`+Seats+factor(pm),data = df)
stargazer(fit_ols_mvw,fit_ols_ssi,fit_ols_pbi,fit_ols_mvw_seats,fit_ols_ssi_seats,fit_ols_pbi_seats,fit_ols_mvw_full,fit_ols_ssi_full,fit_ols_pbi_full,
title = "Power Indice comparison",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
column.labels=c("MVWs","SS-I","PB-I"),
no.space = T,
style = "qje",
float.env = "sidewaystable"
)
stargazer(fit_ols_mvw,fit_ols_ssi,fit_ols_pbi,fit_ols_mvw_seats,fit_ols_ssi_seats,fit_ols_pbi_seats,fit_ols_mvw_full,fit_ols_ssi_full,fit_ols_pbi_full,
title = "Power Indice comparison",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
#column.labels=c("MVWs","SS-I","PB-I"),
no.space = T,
style = "qje",
float.env = "sidewaystable"
)
stargazer(fit_ols_mvw,fit_ols_ssi,fit_ols_pbi,fit_ols_mvw_seats,fit_ols_ssi_seats,fit_ols_pbi_seats,fit_ols_mvw_full,fit_ols_ssi_full,fit_ols_pbi_full,
title = "Power Indice comparison",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
#column.labels=c("MVWs","SS-I","PB-I"),
no.space = T,
#style = "qje",
float.env = "sidewaystable"
)
rm(list = ls())
library(tidyr)
library(httpgd)
library(zoib)
library(arrow)
library(brms)
library(stargazer)
setwd("~/Sebastian Masterthesis/Git repo/masterthesis")
df<-read_feather("long_df.feather")
df$Country<-factor(df$Country)
df$pm<-factor(df$pm)
fit_1<-lm(unweighted_ministries~mvw,data = df)
fit_2<-lm(unweighted_ministries~df$`SS-I`,data = df)
fit_3<-lm(unweighted_ministries~df$`PB-I`,data = df)
fit_4<-lm(unweighted_ministries~mvw+Seats,data = df)
fit_5<-lm(unweighted_ministries~df$`SS-I`+Seats,data = df)
fit_6<-lm(unweighted_ministries~df$`PB-I`+Seats,data = df)
fit_7<-lm(unweighted_ministries~mvw+Seats+factor(pm),data = df)
fit_8<-lm(unweighted_ministries~df$`SS-I`+Seats+factor(pm),data = df)
fit_9<-lm(unweighted_ministries~df$`PB-I`+Seats+factor(pm),data = df)
stargazer(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9,
title = "Power Indice comparison",
align = T,
omit = "Country",
omit.stat=c("adj.rsq","ser","f"),
#column.labels=c("MVWs","SS-I","PB-I"),
no.space = T,
#style = "qje",
float.env = "sidewaystable"
)
install.packages("texreg")
library(texreg)
texreg(list(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9),
dcolumn = T,booktabs = T,
caption = "Comparison of Power Indices",
sideways = T,
bold = 0.05,
omit.coef = "Country",
digits = 3)
texreg(list(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9),
custom.model.names = c("MWV","SS-I","PB-I","MWV","SS-I","PB-I","MWV","SS-I","PB-I"),
custom.header = list("Plain"=1:3,"With Seat Share":4-6,"With Seat Share and PM- Indicator":7-9),
custom.coef.names = c("Intercept","MVw","SS-I","PB-I","Seat Share","Prime Minister"),
dcolumn = T,booktabs = T,
caption = "Comparison of Power Indices",
sideways = T,
bold = 0.05,
omit.coef = "Country",
digits = 3)
texreg(list(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9),
custom.model.names = c("MWV","SS-I","PB-I","MWV","SS-I","PB-I","MWV","SS-I","PB-I"),
custom.header = list("Plain"=1:3,"With Seat Share"=4-6,"With Seat Share and PM- Indicator"=7-9),
custom.coef.names = c("Intercept","MVw","SS-I","PB-I","Seat Share","Prime Minister"),
dcolumn = T,booktabs = T,
caption = "Comparison of Power Indices",
sideways = T,
bold = 0.05,
omit.coef = "Country",
digits = 3)
texreg(list(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9),
custom.model.names = c("MWV","SS-I","PB-I","MWV","SS-I","PB-I","MWV","SS-I","PB-I"),
custom.header = list("Plain"=1:3,"With Seat Share"=4:6,"With Seat Share and PM- Indicator"=7:9),
custom.coef.names = c("Intercept","MVw","SS-I","PB-I","Seat Share","Prime Minister"),
dcolumn = T,booktabs = T,
caption = "Comparison of Power Indices",
sideways = T,
bold = 0.05,
omit.coef = "Country",
digits = 3)
texreg(list(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9),
custom.model.names = c("MWV","SS-I","PB-I","MWV","SS-I","PB-I","MWV","SS-I","PB-I"),
custom.header = list("Plain"=1:3,"With Seat Share"=4:6,"With Seat Share and PM- Indicator"=7:9),
custom.coef.names = c("Intercept","MVW","SS-I","PB-I","Seat Share","Prime Minister"),
dcolumn = T,booktabs = T,
caption = "Comparison of Power Indices",
sideways = T,
bold = 0.05,
omit.coef = "Country",
digits = 3,
include.adjrs=F)
texreg(list(fit_1,fit_2,fit_3,fit_4,fit_5,fit_6,fit_7,fit_8,fit_9),
custom.model.names = c("MWV","SS-I","PB-I","MWV","SS-I","PB-I","MWV","SS-I","PB-I"),
custom.header = list("Plain"=1:3,"With Seat Share"=4:6,"With Seat Share and PM- Indicator"=7:9),
custom.coef.names = c("Intercept","MVW","SS-I","PB-I","Seat Share","Prime Minister"),
dcolumn = T,booktabs = T,
caption = "Comparison of Power Indices",
sideways = T,
bold = 0.05,
omit.coef = "Country",
digits = 3,
include.adjrs=F, include.nobs=F)
